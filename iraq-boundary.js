// Iraq boundary polygon for location validation
// This is a simplified polygon of Iraq's borders
// Source: OpenStreetMap / Natural Earth data

const IRAQ_BOUNDARY = {
  "type": "FeatureCollection",
  "features": [
    {
      "type": "Feature",
      "properties": {
        "name": "Iraq",
        "iso_a2": "IQ",
        "iso_a3": "IRQ"
      },
      "geometry": {
        "type": "Polygon",
        "coordinates": [
          [
            [38.79251861572267, 37.387474060058594],
            [39.31674575805664, 37.08975982666016],
            [40.0690460205078, 36.863636016845703],
            [40.673850059509277, 36.647708892822266],
            [41.78678512573242, 36.7011070251465],
            [42.349349975585938, 37.230186462402344],
            [42.79921340942383, 37.38743209838867],
            [43.94832992553711, 37.25620651245117],
            [44.29207992553711, 37.00207710266113],
            [44.77199172973633, 36.988082885742188],
            [45.06970596313477, 36.629867553710938],
            [45.41345596313477, 36.39378356933594],
            [45.64953994750977, 35.83121871948242],
            [46.15774917602539, 35.67397689819336],
            [46.07671356201172, 35.384078979492188],
            [45.56850051879883, 35.0863800048828125],
            [45.41124725341797, 34.73659896850586],
            [45.51625823974609, 34.45793914794922],
            [45.71719360351563, 34.38691711425781],
            [45.9532470703125, 34.00173568725586],
            [46.14315795898438, 33.76463699340820],
            [46.143157958984375, 33.3374137878418],
            [46.06213760375977, 33.01969909667969],
            [45.953132629394531, 32.701988220214844],
            [45.75219345092773, 32.597991943359375],
            [45.68116760253906, 32.384326934814453],
            [45.51624298095703, 32.128616333007813],
            [45.34234619140625, 31.872901916503906],
            [45.24734115600586, 31.51799774169922],
            [45.0464096069336, 31.203659057617188],
            [44.888885498046875, 30.972618103027344],
            [44.61023712158203, 30.831726074218750],
            [44.331588745117188, 30.800476074218750],
            [43.947479248046875, 30.833206176757813],
            [43.659851074218750, 30.914848327636719],
            [43.296733856201172, 31.061912536621094],
            [42.92361831665039, 31.2506408691406250],
            [42.67788314819336, 31.4106578826904297],
            [42.393096923828125, 31.570674896240234],
            [42.07336044311523, 31.630401611328125],
            [41.790187835693359, 31.616291046142578],
            [41.506916046142578, 31.602182388305664],
            [41.223743438720703, 31.588073730468750],
            [40.94046783447266, 31.573951721191406],
            [40.65729522705078, 31.559864044189453],
            [40.373939514160156, 31.545774459838867],
            [40.16300964355469, 31.610084533691406],
            [39.95196151733398, 31.674497604370117],
            [39.59674072265625, 31.93919754028320],
            [39.308521270751953, 32.14022445678711],
            [39.02030563354492, 32.341064453125],
            [38.94927978515625, 32.50781631469727],
            [38.87825393676758, 32.674552917480469],
            [38.90728378295898, 32.84135818481445],
            [38.93631362915039, 33.008163452148438],
            [39.07736587524414, 33.174694061279297],
            [39.218421936035156, 33.34123611450195],
            [39.359478950500488, 33.507777481079102],
            [39.62421417236328, 33.683917999267578],
            [39.88894653320313, 33.86007308959961],
            [40.07936096191406, 34.164413452148438],
            [40.1893310546875, 34.42572784423828],
            [40.2392921447754, 34.726181030273438],
            [40.23929214477539, 35.026634216308594],
            [40.19942855834961, 35.27076721191406],
            [40.159561157226563, 35.514904022216797],
            [40.13951873779297, 35.74897384643555],
            [40.11947631835938, 35.983043670654297],
            [40.059700012207031, 36.22716522216797],
            [39.99992370605469, 36.47129440307617],
            [39.93924713134766, 36.64800262451172],
            [39.878566741943359, 36.824684143066406],
            [39.817886352539063, 37.001365661621094],
            [39.6773681640625, 37.178062438964844],
            [39.4267883300781250, 37.33480072021484],
            [39.176201248168945, 37.391548156738281],
            [38.92562103271484, 37.48828125],
            [38.792518615722656, 37.387474060058594]
          ]
        ]
      }
    }
  ]
};

// Function to check if a point is inside Iraq
function isPointInIraq(lat, lng) {
  const point = [lng, lat]; // GeoJSON uses [longitude, latitude]
  const polygon = IRAQ_BOUNDARY.features[0].geometry.coordinates[0];
  
  let inside = false;
  let j = polygon.length - 1;
  
  for (let i = 0; i < polygon.length; i++) {
    const xi = polygon[i][0], yi = polygon[i][1];
    const xj = polygon[j][0], yj = polygon[j][1];
    
    if (((yi > point[1]) !== (yj > point[1])) &&
        (point[0] < (xj - xi) * (point[1] - yi) / (yj - yi) + xi)) {
      inside = !inside;
    }
    j = i;
  }
  
  return inside;
}

// Iraqi governorates and major cities for reference
const IRAQI_GOVERNORATES = [
  { name: "Baghdad", lat: 33.3152, lng: 44.3661 },
  { name: "Basra", lat: 30.5085, lng: 47.7804 },
  { name: "Mosul", lat: 36.3350, lng: 43.1189 },
  { name: "Erbil", lat: 36.1911, lng: 44.0094 },
  { name: "Sulaymaniyah", lat: 35.5492, lng: 45.4394 },
  { name: "Najaf", lat: 32.0086, lng: 44.3320 },
  { name: "Karbala", lat: 32.6100, lng: 44.0244 },
  { name: "Kirkuk", lat: 35.4681, lng: 44.3922 },
  { name: "Diyala", lat: 33.7498, lng: 44.6198 },
  { name: "Anbar", lat: 33.4206, lng: 43.2889 },
  { name: "Babylon", lat: 32.5426, lng: 44.4205 },
  { name: "Dhi Qar", lat: 31.0569, lng: 46.2588 },
  { name: "Qadisiyyah", lat: 31.9980, lng: 45.0037 },
  { name: "Maysan", lat: 31.9306, lng: 47.1500 },
  { name: "Muthanna", lat: 29.7604, lng: 45.3706 },
  { name: "Wasit", lat: 32.8833, lng: 45.8333 },
  { name: "Saladin", lat: 34.2083, lng: 43.6778 },
  { name: "Nineveh", lat: 36.3278, lng: 43.1453 }
];

// Export for use in other modules
if (typeof module !== 'undefined' && module.exports) {
  module.exports = { IRAQ_BOUNDARY, isPointInIraq, IRAQI_GOVERNORATES };
}